<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>코스닥 신규상장 - VC 매매금액 분석</title>
    <!--
        데이터 출처: DART 대량보유상황보고서 (dart.fss.or.kr)
        VC 식별: VC_선별_워크플로우.md 참조
        분석 대상:
          - 신규상장 시점 보유 VC (보통주/CB/BW 등 전체)의
          - 이후 보통주(의결권있는 주식) 매매만 포함
          - 장내매매, 장외매매, 시간외매매
          - 거래금액 = 단가(HLD_UNT_PR) × 변동수량(MDF_SDK_CNT)
    -->
    <script src="https://cdn.plot.ly/plotly-2.35.0.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', -apple-system, sans-serif; background: #0f1117; color: #e0e0e0; }
        .header { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); padding: 28px 40px; border-bottom: 1px solid #2a2a4a; }
        .header h1 { font-size: 24px; font-weight: 600; color: #fff; }
        .header p { font-size: 14px; color: #888; margin-top: 5px; }
        .header .note { font-size: 11px; color: #666; margin-top: 10px; line-height: 1.6; border-top: 1px solid #2a2a4a; padding-top: 10px; }
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; padding: 18px 40px; }
        .summary-card { background: #1a1d29; border: 1px solid #2a2d3a; border-radius: 10px; padding: 14px 16px; }
        .summary-card .label { font-size: 10px; color: #888; text-transform: uppercase; letter-spacing: .5px; }
        .summary-card .value { font-size: 20px; font-weight: 700; margin-top: 3px; }
        .summary-card .sub { font-size: 11px; color: #666; margin-top: 2px; }
        .positive { color: #ef4444; } .negative { color: #3b82f6; } .neutral { color: #fff; }
        .chart-container { padding: 10px 40px; }
        .chart-box { background: #1a1d29; border: 1px solid #2a2d3a; border-radius: 10px; padding: 20px; margin-bottom: 14px; }
        .chart-title { font-size: 16px; font-weight: 600; margin-bottom: 3px; color: #fff; }
        .chart-subtitle { font-size: 12px; color: #888; margin-bottom: 10px; }
        .tab-bar { display: flex; gap: 4px; padding: 10px 40px 0; }
        .tab { padding: 10px 20px; background: #1a1d29; border: 1px solid #2a2d3a; border-bottom: none; border-radius: 8px 8px 0 0; cursor: pointer; font-size: 13px; color: #888; transition: all .15s; }
        .tab:hover { color: #ccc; } .tab.active { color: #fff; border-color: #3b82f6; }
        table.ranking { width: 100%; border-collapse: collapse; font-size: 13px; }
        table.ranking th { text-align: left; padding: 8px 10px; color: #888; border-bottom: 1px solid #2a2d3a; font-weight: 500; font-size: 11px; }
        table.ranking td { padding: 6px 10px; border-bottom: 1px solid #1f2230; }
        table.ranking tr:hover { background: #1f2233; }
        .bar-cell { display: flex; align-items: center; gap: 6px; }
        .bar-fill { height: 6px; border-radius: 3px; min-width: 2px; }
        /* ── VC 확인기준 탭 ── */
        .doc { padding: 24px 32px; line-height: 1.8; font-size: 14px; color: #d0d0d0; }
        .doc h2 { font-size: 18px; font-weight: 700; color: #fff; margin: 28px 0 12px; padding-bottom: 6px; border-bottom: 1px solid #2a2d3a; }
        .doc h2:first-child { margin-top: 0; }
        .doc h3 { font-size: 15px; font-weight: 600; color: #e0e0e0; margin: 20px 0 8px; }
        .doc p { margin: 6px 0; }
        .doc blockquote { border-left: 3px solid #3b82f6; padding: 8px 16px; margin: 10px 0; background: rgba(59,130,246,0.08); border-radius: 0 6px 6px 0; color: #93c5fd; font-weight: 500; }
        .doc ul, .doc ol { margin: 6px 0 6px 20px; }
        .doc li { margin: 3px 0; }
        .doc table { width: 100%; border-collapse: collapse; margin: 10px 0; font-size: 13px; }
        .doc th { text-align: left; padding: 8px 12px; background: #1f2233; color: #93c5fd; border-bottom: 2px solid #2a2d3a; font-weight: 600; font-size: 12px; white-space: nowrap; }
        .doc td { padding: 6px 12px; border-bottom: 1px solid #1f2230; vertical-align: top; }
        .doc tr:hover { background: #1a1d2a; }
        .doc .tag-include { display: inline-block; padding: 1px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; background: rgba(239,68,68,0.15); color: #ef4444; }
        .doc .tag-exclude { display: inline-block; padding: 1px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; background: rgba(59,130,246,0.15); color: #60a5fa; }
        .doc .tag-keyword { display: inline-block; padding: 2px 8px; margin: 2px; border-radius: 4px; font-size: 12px; background: #1f2233; color: #a78bfa; border: 1px solid #3a3d4a; font-family: monospace; }
        .doc .stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 10px; margin: 12px 0; }
        .doc .stat-item { background: #1a1d29; border: 1px solid #2a2d3a; border-radius: 8px; padding: 12px 16px; text-align: center; }
        .doc .stat-item .num { font-size: 22px; font-weight: 700; color: #fff; }
        .doc .stat-item .desc { font-size: 11px; color: #888; margin-top: 2px; }
        .doc .case-box { background: #14161e; border: 1px solid #2a2d3a; border-radius: 8px; padding: 14px 18px; margin: 10px 0; }
        .doc .case-box .case-title { font-size: 13px; font-weight: 600; color: #f59e0b; margin-bottom: 6px; }
        .doc .case-box ul { margin: 4px 0 4px 16px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>코스닥 신규상장 종목 - VC 매매금액 분석</h1>
        <p>신규상장 시점 보유 VC의 상장 후 보통주 매매 <b>거래대금</b> 분석 (단가 &times; 수량)</p>
        <div class="note">
            데이터: DART 대량보유상황보고서 &nbsp;|&nbsp;
            대상: 신규상장 시점 보유 VC 675사 &rarr; 이후 보통주(의결권있는 주식) 매매 &nbsp;|&nbsp;
            분석 대상: <b>장내매매, 장외매매, 시간외매매</b>만 포함 &nbsp;|&nbsp;
            금액 = HLD_UNT_PR &times; MDF_SDK_CNT
        </div>
    </div>

    <div class="summary-grid" id="summaryGrid"></div>

    <div class="tab-bar" id="tabBar">
        <div class="tab active" data-tab="net">순매매금액</div>
        <div class="tab" data-tab="type">매매유형별</div>
        <div class="tab" data-tab="corp">종목 랭킹</div>
        <div class="tab" data-tab="vc">VC 랭킹</div>
        <div class="tab" data-tab="early">조기매도</div>
        <div class="tab" data-tab="criteria">VC 확인기준</div>
    </div>

    <!-- 탭1: 순매매금액 -->
    <div id="tab-net" class="chart-container">
        <div class="chart-box">
            <div class="chart-title">경과일별 VC 순매매금액 (30일 단위)</div>
            <div class="chart-subtitle">상장일 기준 경과일 구간별 순매매금액 합계 (전 종목 합산). 점선 = 보호예수 해제 기준일</div>
            <div id="chartNetBar" style="height:420px;"></div>
        </div>
        <div class="chart-box">
            <div class="chart-title">누적 순매매금액 추이</div>
            <div class="chart-subtitle">경과일에 따른 VC의 누적 순매매금액 변화</div>
            <div id="chartCumulative" style="height:360px;"></div>
        </div>
    </div>

    <!-- 탭2: 매매유형별 -->
    <div id="tab-type" class="chart-container" style="display:none;">
        <div class="chart-box">
            <div class="chart-title">매매유형별 총 거래대금</div>
            <div id="chartTypeBar" style="height:340px;"></div>
        </div>
        <div class="chart-box">
            <div class="chart-title">매매유형별 경과일 추이 (금액)</div>
            <div class="chart-subtitle">범례 클릭으로 개별 유형 토글</div>
            <div id="chartTypeTime" style="height:400px;"></div>
        </div>
    </div>

    <!-- 탭3: 종목 랭킹 -->
    <div id="tab-corp" class="chart-container" style="display:none;">
        <div class="chart-box">
            <div class="chart-title">순매도금액 상위 종목 TOP 30 (VC 엑시트 규모)</div>
            <div class="chart-subtitle">상장일 ~ +24개월(720일) 기간 집계</div>
            <div id="tableSell"></div>
        </div>
        <div class="chart-box">
            <div class="chart-title">순매수금액 상위 종목 TOP 30</div>
            <div class="chart-subtitle">상장일 ~ +24개월(720일) 기간 집계</div>
            <div id="tableBuy"></div>
        </div>
    </div>

    <!-- 탭4: VC 랭킹 -->
    <div id="tab-vc" class="chart-container" style="display:none;">
        <div class="chart-box">
            <div class="chart-title">순매도금액 상위 VC TOP 30</div>
            <div class="chart-subtitle">가장 많이 매도한 VC(주주) - 금액 기준 | 상장일 ~ +24개월(720일) 기간 집계</div>
            <div id="tableVCSell"></div>
        </div>
        <div class="chart-box">
            <div class="chart-title">순매수금액 상위 VC TOP 30</div>
            <div class="chart-subtitle">가장 많이 매수한 VC(주주) - 금액 기준 | 상장일 ~ +24개월(720일) 기간 집계</div>
            <div id="tableVCBuy"></div>
        </div>
    </div>

    <!-- 탭: 조기매도 (6개월 이내) -->
    <div id="tab-early" class="chart-container" style="display:none;">
        <div class="chart-box">
            <div class="chart-title">상장 후 6개월 이내 순매도금액 상위 종목 TOP 30</div>
            <div class="chart-subtitle">상장일 ~ +180일 이내 VC 매매만 집계. 클릭하면 개별 공시내역 펼침</div>
            <div id="tableEarlySell"></div>
        </div>
    </div>

    <!-- 탭5: VC 확인기준 -->
    <div id="tab-criteria" class="chart-container" style="display:none;">

        <!-- 5-1. 개요 + 선별 통계 -->
        <div class="chart-box">
            <div class="doc">
                <h2>VC 선별 개요</h2>
                <p>코스닥 신규상장 종목의 <b>DART 대량보유상황보고서</b>에 등장하는 법인/펀드 주주 1,325사 중, VC(벤처캐피탈)에 해당하는 주주를 식별하여 매매 분석 대상으로 선정한 과정.</p>
                <div class="stat-grid" id="selStatGrid"></div>
            </div>
        </div>

        <!-- 5-2. 핵심 원칙 -->
        <div class="chart-box">
            <div class="doc">
                <h2>핵심 원칙</h2>
                <blockquote>본업이 벤처/스타트업 투자인지가 유일한 핵심 기준이다.</blockquote>
                <ol>
                    <li>VCS(벤처투자종합포털) 등록, KVCA 회원 등 <b>공식 목록 매칭을 우선</b> 참조하되, 등록만으로 자동 포함하지 않음 (증권사가 신기술사로 등록된 경우 등)</li>
                    <li>키워드 매칭은 <b>후보 추출용</b>이며, 최종 판단은 실체 확인 후 결정</li>
                    <li>법적 라이선스(신기술사 등)가 있더라도 <b>부수적 업무이면 제외</b></li>
                </ol>
            </div>
        </div>

        <!-- 5-3. 선별 프로세스 -->
        <div class="chart-box">
            <div class="doc">
                <h2>선별 프로세스 (6단계)</h2>

                <h3>Step 1. 분석대상 추출</h3>
                <p>원본 데이터(<code>daeryang_hld_mth_ipo_2.5yr</code>)에서 개인(주민번호) 제외, 법인/펀드만 추출 &rarr; <b>1,581행 (1,325 고유 사업자번호)</b></p>

                <h3>Step 2. Phase 1: 참조 데이터 직접 매칭 (6단계)</h3>
                <table>
                    <thead><tr><th>Phase</th><th>방법</th><th>참조 데이터</th></tr></thead>
                    <tbody>
                        <tr><td><b>1A</b></td><td>KVCA 조합명 exact match</td><td>kvca_조합현황.csv (2,401건)</td></tr>
                        <tr><td><b>1B</b></td><td>VCS 등록 벤처투자회사명 match</td><td>등록_벤처투자회사_목록.csv (726건)</td></tr>
                        <tr><td><b>1C</b></td><td>KVCA 회원사명 match</td><td>kvca_회원사_목록.csv (213건)</td></tr>
                        <tr><td><b>1D</b></td><td>모태펀드 운용사명 match</td><td>모태펀드 자조합 운용사정보.csv (1,411건)</td></tr>
                        <tr><td><b>1E</b></td><td>GP명이 SPC_NM에 부분포함 (4자 이상)</td><td>위 GP명 통합</td></tr>
                        <tr><td><b>1F</b></td><td>창업벤처전문 PEF명 부분매칭</td><td>창업벤처전문_PEF.xlsx (151건)</td></tr>
                    </tbody>
                </table>

                <h3>Step 3. Phase 2: 사업자등록번호 역매칭</h3>
                <p>Phase 1에서 확인된 VC의 사업자번호(SPC_ID2)로 미매칭 행을 추가 포착. 동일 사업자번호 = 같은 GP 산하 다른 펀드/조합.</p>

                <h3>Step 4. Phase 3~4: 키워드 후보 + 제외 규칙</h3>
                <p><b>Phase 3</b>: VC 관련 키워드(<code>투자조합, 벤처투자, 인베스트먼트, 캐피탈, 파트너스, 펀드</code> 등)로 후보 추출.</p>
                <p><b>Phase 4</b>: 제외 규칙 적용 &mdash; 증권사, 자산운용사, 여신전문금융 캐피탈, 구조조정/M&A/메자닌 전문 펀드, 일반 PEF 등을 제외.</p>

                <h3>Step 5. Phase 5: 자동분류 + 웹서치 검증</h3>
                <ul>
                    <li><b>5-A 자동포함</b>: "투자조합", "벤처투자", "창업투자" 등 VC 확실 패턴</li>
                    <li><b>5-B 영문명 전수 제외</b>: 해외법인 직접 투자분 (한국 VC업계 분석 목적)</li>
                    <li><b>5-C 웹서치 검증</b>: 나머지 후보 82건을 개별 검색하여 실체 확인</li>
                </ul>

                <h3>Step 6. 최종 병합 + 대량보유 데이터 필터링</h3>
                <p>전 단계 결과를 병합하고 중복 제거(제외가 포함보다 우선) &rarr; VC 710사 확정 &rarr; 원본 대량보유 데이터에서 VC 주주만 추출.</p>
            </div>
        </div>

        <!-- 5-4. Phase별 선별 통계 차트 -->
        <div class="chart-box">
            <div class="doc">
                <h2>Phase별 선별 결과</h2>
                <div id="chartPhaseBar" style="height:320px;"></div>
            </div>
        </div>

        <!-- 5-5. 포함/제외 기준 상세 -->
        <div class="chart-box">
            <div class="doc">
                <h2>포함 대상 <span class="tag-include">INCLUDE</span></h2>
                <table>
                    <thead><tr><th>유형</th><th>설명</th><th>예시</th></tr></thead>
                    <tbody>
                        <tr><td>벤처투자회사(창투사)</td><td>벤처투자 촉진에 관한 법률 등록</td><td>한국투자파트너스, 스톤브릿지벤처스</td></tr>
                        <tr><td>신기술사업금융업자</td><td>벤처투자가 <b>본업</b>인 신기술금융사</td><td>에스티캐피탈, 무림캐피탈</td></tr>
                        <tr><td>투자조합/벤처펀드</td><td>VC가 GP로 운용하는 투자조합/펀드</td><td>스톤브릿지2020벤처투자조합</td></tr>
                        <tr><td>CVC(기업형 VC)</td><td>대기업 전담 벤처투자 자회사</td><td>펄어비스캐피탈, 롯데벤처스</td></tr>
                        <tr><td>액셀러레이터</td><td>초기 스타트업 투자/보육</td><td>빅뱅벤처스, 제로원액셀러레이터</td></tr>
                        <tr><td>창업벤처전문 PEF</td><td>"창업벤처전문" 등록 사모투자합자회사</td><td>유암코헬리오스중소기업성장창업벤처전문PEF</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="chart-box">
            <div class="doc">
                <h2>제외 대상 <span class="tag-exclude">EXCLUDE</span></h2>
                <table>
                    <thead><tr><th>유형</th><th>판단 근거</th><th>예시</th></tr></thead>
                    <tbody>
                        <tr><td><b>증권사</b></td><td>IPO 주관/인수/중개가 본업. 신기술사 등록도 부수적</td><td>미래에셋증권, NH투자증권, 한화투자증권</td></tr>
                        <tr><td><b>자산운용사</b></td><td>공모펀드/ETF/헤지펀드 운용이 본업</td><td>미래에셋자산운용, 키움투자자산운용</td></tr>
                        <tr><td><b>캐피탈사(여신전문금융)</b></td><td>리스/대출/할부금융이 본업</td><td>키움캐피탈, 메리츠캐피탈, 산은캐피탈</td></tr>
                        <tr><td><b>투자자문/투자일임</b></td><td>공모주/메자닌/상장주식 자문이 본업</td><td>마블투자자문, 브라이트투자자문</td></tr>
                        <tr><td><b>구조조정 펀드</b></td><td>"기업재무안정"/"턴어라운드"/"크레딧" 목적</td><td>유진신영기업구조혁신PEF</td></tr>
                        <tr><td><b>일반 PEF</b></td><td>창업벤처전문 미등록 사모투자합자회사</td><td>린드먼아시아글로벌파이오니어PEF</td></tr>
                        <tr><td><b>메자닌 전문</b></td><td>벤처투자가 아닌 메자닌 전문 펀드/투자조합</td><td>한양타임메자닌신기술투자조합</td></tr>
                        <tr><td><b>해외법인</b></td><td>한국 VC업계 분석 목적이므로 해외 본체 제외</td><td>Kayne Anderson, Virtus KAR</td></tr>
                        <tr><td><b>M&A 전문 PE</b></td><td>M&A/바이아웃 전문</td><td>코메스2018-1M&A투자조합</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 5-6. 제외사유별 분포 차트 -->
        <div class="chart-box">
            <div class="doc">
                <h2>제외사유별 분포</h2>
                <div id="chartExReasonBar" style="height:300px;"></div>
            </div>
        </div>

        <!-- 5-7. 경계 사례 -->
        <div class="chart-box">
            <div class="doc">
                <h2>주요 경계 사례</h2>
                <div class="case-box">
                    <div class="case-title">"캐피탈" &mdash; 개별 확인 필수</div>
                    <ul>
                        <li><span class="tag-exclude">제외</span> 여신전문금융 (리스/대출): 산은캐피탈, 신한캐피탈, 하나캐피탈, 메리츠캐피탈, 키움캐피탈</li>
                        <li><span class="tag-include">포함</span> 벤처캐피탈/CVC: 타임폴리오캐피탈, 펄어비스캐피탈, 뉴메인캐피탈, 무림캐피탈, 에스티캐피탈</li>
                    </ul>
                </div>
                <div class="case-box">
                    <div class="case-title">"자산운용" &mdash; 대부분 제외, VCS 등록 VC는 포함</div>
                    <ul>
                        <li><span class="tag-exclude">제외</span> 일반 자산운용사: 미래에셋자산운용, 한국투자밸류자산운용, 제이씨에셋자산운용</li>
                        <li><span class="tag-include">포함</span> VCS 등록 + 벤처투자 활동: 아이온자산운용, 타이거자산운용투자일임</li>
                    </ul>
                </div>
                <div class="case-box">
                    <div class="case-title">PEF &mdash; "창업벤처전문" 등록 여부로 구분</div>
                    <ul>
                        <li><span class="tag-exclude">제외</span> 일반 PEF: 기업재무안정, 턴어라운드, 스페셜시츄에이션 목적</li>
                        <li><span class="tag-include">포함</span> 창업벤처전문 PEF: VC가 GP, 벤처투자 목적 명시</li>
                    </ul>
                </div>
                <div class="case-box">
                    <div class="case-title">GP명 부분매칭 오탐 방지</div>
                    <ul>
                        <li>3글자 이하 GP명은 부분매칭에서 제외</li>
                        <li>역방향 매칭(SPC_NM이 GP명에 포함) 불허 &mdash; 일반 기업명이 VC명에 우연히 포함되는 경우 방지</li>
                        <li>오탐 사례: 스노우 &ne; 스노우볼벤처스, 카카오 &ne; 카카오벤처스, 에코프로 &ne; 에코프로파트너스</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- 5-8. VC 목록 (검색 가능한 테이블) -->
        <div class="chart-box">
            <div class="doc">
                <h2>VC 선별결과 목록 (<span id="vcListCount">710</span>사)</h2>
                <div style="display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap;align-items:center;">
                    <input type="text" id="vcSearchInput" placeholder="VC명, GP명, Phase로 검색..." style="flex:1;min-width:200px;padding:8px 12px;background:#14161e;border:1px solid #2a2d3a;border-radius:6px;color:#e0e0e0;font-size:13px;">
                    <select id="vcPhaseFilter" style="padding:8px 10px;background:#14161e;border:1px solid #2a2d3a;border-radius:6px;color:#e0e0e0;font-size:13px;">
                        <option value="">전체 Phase</option>
                    </select>
                    <select id="vcTypeFilter" style="padding:8px 10px;background:#14161e;border:1px solid #2a2d3a;border-radius:6px;color:#e0e0e0;font-size:13px;">
                        <option value="">전체 유형</option>
                        <option value="GP(운용사)">GP(운용사)</option>
                        <option value="펀드/조합">펀드/조합</option>
                    </select>
                    <span id="vcFilterCount" style="font-size:12px;color:#888;"></span>
                </div>
                <div id="vcListTable" style="max-height:500px;overflow-y:auto;"></div>
            </div>
        </div>

        <!-- 5-9. 제외 목록 -->
        <div class="chart-box">
            <div class="doc">
                <h2>제외 목록 (<span id="exListCount">107</span>사)</h2>
                <div style="display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap;align-items:center;">
                    <input type="text" id="exSearchInput" placeholder="이름, 제외사유로 검색..." style="flex:1;min-width:200px;padding:8px 12px;background:#14161e;border:1px solid #2a2d3a;border-radius:6px;color:#e0e0e0;font-size:13px;">
                    <select id="exReasonFilter" style="padding:8px 10px;background:#14161e;border:1px solid #2a2d3a;border-radius:6px;color:#e0e0e0;font-size:13px;">
                        <option value="">전체 사유</option>
                    </select>
                    <span id="exFilterCount" style="font-size:12px;color:#888;"></span>
                </div>
                <div id="exListTable" style="max-height:400px;overflow-y:auto;"></div>
            </div>
        </div>

        <!-- 5-10. 미확인 -->
        <div class="chart-box">
            <div class="doc">
                <h2>수동확인 필요 (<span id="unkListCount">6</span>건)</h2>
                <p style="font-size:12px;color:#888;margin-bottom:10px;">웹서치로도 VC 여부를 확인할 수 없는 항목. 보수적으로 분석에서 제외.</p>
                <div id="unkListTable"></div>
            </div>
        </div>

    </div>

<script>
let DATA = null, SEL = null;
Promise.all([
    fetch('vc_analysis_amt.json?t='+Date.now()).then(r=>{if(!r.ok)throw new Error('amt.json: '+r.status);return r.json();}),
    fetch('vc_selection_data.json?t='+Date.now()).then(r=>{if(!r.ok)throw new Error('selection.json: '+r.status);return r.json();})
]).then(([d,s])=>{DATA=d;SEL=s;init();}).catch(e=>document.body.innerHTML='<h2 style="color:red;padding:40px">JSON 로드 실패: '+e.message+'</h2>');

function init(){
    renderSummary();
    renderNetBar();
    renderCumulative();

    initTabs();
}

/* ── Util ── */
function fmtAmt(n){
    const a=Math.abs(n),s=n<0?'-':'';
    if(a>=1e12)return s+(a/1e12).toFixed(1)+'조';
    if(a>=1e8)return s+(a/1e8).toFixed(0)+'억';
    if(a>=1e4)return s+Math.round(a/1e4)+'만';
    return n.toLocaleString();
}
function fmtAmtDetail(n){
    const a=Math.abs(n),s=n<0?'-':'';
    if(a>=1e12){const t=Math.floor(a/1e12),b=Math.round((a%1e12)/1e8);return s+t+'조 '+b.toLocaleString()+'억';}
    if(a>=1e8)return s+(a/1e8).toFixed(0)+'억';
    if(a>=1e4)return s+Math.round(a/1e4)+'만';
    return n.toLocaleString()+'원';
}
function fmtShares(n){
    const a=Math.abs(n),s=n<0?'-':'';
    if(a>=1e8)return s+(a/1e8).toFixed(1)+'억주';
    if(a>=1e4)return s+Math.round(a/1e4)+'만주';
    return n.toLocaleString()+'주';
}

function fmtAxisKRW(n){
    const a=Math.abs(n),s=n<0?'-':'';
    if(a>=1e12)return s+(a/1e12).toFixed(1)+'조';
    if(a>=1e8)return s+(a/1e8).toFixed(0)+'억';
    if(a>=1e4)return s+Math.round(a/1e4)+'만';
    if(a===0)return '0';
    return n.toLocaleString();
}
function krwYAxis(values,title){
    const mn=Math.min(...values),mx=Math.max(...values);
    const range=mx-mn||1;
    const step=(() => {
        const raw=range/6;
        const mag=Math.pow(10,Math.floor(Math.log10(raw)));
        const nice=[1,2,5,10].find(m=>m*mag>=raw)*mag;
        return nice;
    })();
    const start=Math.floor(mn/step)*step, end=Math.ceil(mx/step)*step;
    const tvals=[];
    for(let v=start;v<=end+step/2;v+=step) tvals.push(v);
    return {gridcolor:'#2a2d3a',zerolinecolor:'#3a3d4a',title:title,tickvals:tvals,ticktext:tvals.map(fmtAxisKRW)};
}

const TYPE_COLORS={'장내매도':'#3b82f6','장내매수':'#ef4444','장외매도':'#60a5fa','장외매수':'#f87171','시간외매매':'#a78bfa'};

const DARK={
    paper_bgcolor:'rgba(0,0,0,0)',plot_bgcolor:'rgba(0,0,0,0)',
    font:{color:'#ccc',size:12},
    xaxis:{gridcolor:'#2a2d3a',zerolinecolor:'#3a3d4a'},
    yaxis:{gridcolor:'#2a2d3a',zerolinecolor:'#3a3d4a'},
    margin:{l:90,r:30,t:20,b:50},
    hoverlabel:{bgcolor:'#1a1d29',font:{color:'#fff'}},
};

/* 보호예수 해제 기준선 */
const VLINES = [
    {day:180, label:'6개월', color:'#f59e0b'},
    {day:365, label:'1년', color:'#22c55e'},
    {day:540, label:'18개월', color:'#ec4899'},
    {day:730, label:'2년', color:'#8b5cf6'},
];

function addVLines(layout) {
    layout.shapes = VLINES.map(v => ({
        type:'line', x0:v.day, x1:v.day, y0:0, y1:1, yref:'paper',
        line:{color:v.color, width:1.5, dash:'dot'},
    }));
    layout.annotations = VLINES.map(v => ({
        x:v.day, y:1.02, yref:'paper', text:v.label,
        showarrow:false, font:{size:10,color:v.color}, xanchor:'center',
    }));
    return layout;
}

/* ── Summary ── */
function renderSummary(){
    const s=DATA.summary;
    const cards=[
        {l:'분석 종목',v:s.total_stocks+'개',c:'neutral',sub:'신규상장 시점 VC '+s.ipo_vc_count+'사'},
        {l:'매매 VC',v:s.total_vcs+'사',c:'neutral',sub:s.total_records.toLocaleString()+'건'},
        {l:'매수 금액',v:fmtAmt(s.buy_amount)+'원',c:'positive',sub:s.buy_count.toLocaleString()+'건 / '+fmtShares(s.buy_shares)},
        {l:'매도 금액',v:fmtAmt(s.sell_amount)+'원',c:'negative',sub:s.sell_count.toLocaleString()+'건 / '+fmtShares(s.sell_shares)},
        {l:'순매매금액',v:fmtAmtDetail(s.total_net_amount)+'원',c:s.total_net_amount>=0?'positive':'negative',sub:fmtShares(s.total_net_shares)},
    ];
    document.getElementById('summaryGrid').innerHTML=cards.map(c=>
        `<div class="summary-card"><div class="label">${c.l}</div><div class="value ${c.c}">${c.v}</div>${c.sub?'<div class="sub">'+c.sub+'</div>':''}</div>`
    ).join('');

}

/* ── 탭1 ── */
function renderNetBar(){
    const d=DATA.total_bin;
    const yvals=d.map(r=>r.net);
    const layout=addVLines({...DARK, xaxis:{...DARK.xaxis,title:'상장 후 경과일',dtick:60}, yaxis:krwYAxis(yvals,'순매매금액')});
    Plotly.newPlot('chartNetBar',[{
        x:d.map(r=>r.days),y:yvals,type:'bar',
        marker:{color:d.map(r=>r.net>=0?'#ef4444':'#3b82f6')},
        hovertemplate:'경과일 %{x}~%{x}+30일<br>순매매: %{y:,.0f}원<extra></extra>'
    }],layout,{responsive:true});
}

function renderCumulative(){
    const d=DATA.total_bin;
    const yvals=d.map(r=>r.cum);
    const layout=addVLines({...DARK, xaxis:{...DARK.xaxis,title:'상장 후 경과일',dtick:60}, yaxis:krwYAxis(yvals,'누적 순매매금액')});
    Plotly.newPlot('chartCumulative',[{
        x:d.map(r=>r.days),y:yvals,type:'scatter',mode:'lines',
        fill:'tozeroy',line:{color:'#8b5cf6',width:2},fillcolor:'rgba(139,92,246,0.12)',
        hovertemplate:'경과일 %{x}일<br>누적: %{y:,.0f}원<extra></extra>'
    }],layout,{responsive:true});
}

/* ── 탭2 ── */
function renderTypeBar(){
    const d=DATA.type_total;
    const yvals=d.map(r=>r.total_amount);
    Plotly.newPlot('chartTypeBar',[{
        x:d.map(r=>r.type),y:yvals,type:'bar',
        marker:{color:d.map(r=>TYPE_COLORS[r.type]||'#888')},
        text:d.map(r=>fmtAmt(r.total_amount)+'원 ('+r.count+'건)'),textposition:'outside',textfont:{color:'#aaa',size:11},
        hovertemplate:'%{x}<br>%{y:,.0f}원<extra></extra>'
    }],{...DARK,xaxis:{...DARK.xaxis},yaxis:krwYAxis(yvals,'총 거래대금'),margin:{...DARK.margin,b:70}},{responsive:true});
}

function renderTypeTime(){
    const traces=DATA.types.map(t=>{
        const pts=DATA.type_pivot.map(r=>({d:r.days,v:r[t]||0}));
        return{x:pts.map(p=>p.d),y:pts.map(p=>p.v),name:t,type:'scatter',mode:'lines',
            line:{color:TYPE_COLORS[t]||'#888',width:2},hovertemplate:t+'<br>경과일 %{x}일: %{y:,.0f}원<extra></extra>'};
    });
    const allVals=DATA.types.flatMap(t=>DATA.type_pivot.map(r=>r[t]||0));
    const layout=addVLines({...DARK,xaxis:{...DARK.xaxis,title:'상장 후 경과일',dtick:60},yaxis:krwYAxis(allVals,'거래대금'),
        legend:{orientation:'h',y:-0.18,font:{size:11}},margin:{...DARK.margin,b:90}});
    Plotly.newPlot('chartTypeTime',traces,layout,{responsive:true});
}

/* ── 탭3: 종목 랭킹 ── */
function renderCorpRanking(){
    renderCorpTable('tableSell',DATA.corp_top_sell);
    renderCorpTable('tableBuy',DATA.corp_top_buy);
}

function fmtVCs(vcs){
    if(!vcs||!vcs.length)return'-';
    const s=vcs.slice(0,3).join(', ');
    return vcs.length>3?s+' 외 '+(vcs.length-3)+'사':s;
}

function renderCorpTable(id,list){
    const maxAbs=Math.max(...list.map(r=>Math.abs(r.net_amount)));
    let h='<table class="ranking"><thead><tr><th>#</th><th>종목명</th><th>순매매금액</th><th>매도금액</th><th>매수금액</th><th>건수</th><th>매도 VC</th><th>매수 VC</th><th></th></tr></thead><tbody>';
    list.forEach((r,i)=>{
        const pct=Math.abs(r.net_amount)/maxAbs*100;
        const color=r.net_amount>=0?'#ef4444':'#3b82f6';
        h+=`<tr><td>${i+1}</td><td><b>${r.corp_name}</b></td>
            <td class="${r.net_amount>=0?'positive':'negative'}">${fmtAmt(r.net_amount)}원</td>
            <td style="color:#3b82f6">${fmtAmt(r.sell_amount)}원</td>
            <td style="color:#ef4444">${r.buy_amount?'+'+fmtAmt(r.buy_amount)+'원':'0'}</td>
            <td>${r.tx_count}</td>
            <td style="color:#888;font-size:11px;max-width:240px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap" title="${(r.sell_vcs||[]).join(', ')}">${fmtVCs(r.sell_vcs)}</td>
            <td style="color:#888;font-size:11px;max-width:240px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap" title="${(r.buy_vcs||[]).join(', ')}">${fmtVCs(r.buy_vcs)}</td>
            <td style="width:16%"><div class="bar-cell"><div class="bar-fill" style="width:${pct}%;background:${color}"></div></div></td></tr>`;
    });
    h+='</tbody></table>';
    document.getElementById(id).innerHTML=h;
}

/* ── 탭4: VC 랭킹 ── */
function renderVCRanking(){
    renderVCTable('tableVCSell',DATA.vc_top_sell);
    renderVCTable('tableVCBuy',DATA.vc_top_buy);
}

function renderVCTable(id,list){
    const maxAbs=Math.max(...list.map(r=>Math.abs(r.net_amount)));
    let h='<table class="ranking"><thead><tr><th>#</th><th>VC(주주명)</th><th>순매매금액</th><th>매도금액</th><th>매수금액</th><th>건수</th><th>투자종목</th><th></th></tr></thead><tbody>';
    list.forEach((r,i)=>{
        const pct=Math.abs(r.net_amount)/maxAbs*100;
        const color=r.net_amount>=0?'#ef4444':'#3b82f6';
        const corps=r.corps.slice(0,3).join(', ')+(r.corps.length>3?' 외 '+(r.corps.length-3)+'개':'');
        h+=`<tr><td>${i+1}</td><td><b>${r.SPC_NM}</b></td>
            <td class="${r.net_amount>=0?'positive':'negative'}">${fmtAmt(r.net_amount)}원</td>
            <td style="color:#3b82f6">${fmtAmt(r.sell_amount)}원</td>
            <td style="color:#ef4444">${r.buy_amount?'+'+fmtAmt(r.buy_amount)+'원':'0'}</td>
            <td>${r.tx_count}</td>
            <td style="color:#888;font-size:11px;max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${corps}</td>
            <td style="width:20%"><div class="bar-cell"><div class="bar-fill" style="width:${pct}%;background:${color}"></div></div></td></tr>`;
    });
    h+='</tbody></table>';
    document.getElementById(id).innerHTML=h;
}

/* ── 탭5: VC 확인기준 렌더링 ── */
let criteriaRendered = false;

function renderCriteria(){
    if(criteriaRendered || !SEL) return;
    criteriaRendered = true;

    const ss = SEL.summary;

    // 선별 통계 카드
    document.getElementById('selStatGrid').innerHTML = [
        {n: ss.total_candidates.toLocaleString()+'사', d:'분석 대상 (법인/펀드)'},
        {n: '<span style="color:#ef4444">'+ss.vc_count+'사</span>', d:'VC 확정'},
        {n: ss.excluded_count+'사', d:'제외 확정'},
        {n: ss.unknown_count+'건', d:'수동확인 필요'},
        {n: ss.unmatched_count+'사', d:'미매칭 (VC 무관)'},
        {n: ss.vc_gp_count+'사', d:'GP(운용사)'},
        {n: ss.vc_fund_count+'개', d:'펀드/조합'},
    ].map(c=>'<div class="stat-item"><div class="num">'+c.n+'</div><div class="desc">'+c.d+'</div></div>').join('');

    // Phase별 차트
    const ps = SEL.phase_stats;
    Plotly.newPlot('chartPhaseBar',[{
        x: ps.map(p=>p.phase),
        y: ps.map(p=>p.count),
        type:'bar',
        marker:{color: ps.map(p=>p.phase.startsWith('1')?'#3b82f6':p.phase==='2'?'#22c55e':p.phase==='5_auto'?'#f59e0b':'#a78bfa')},
        text: ps.map(p=>p.count+'건'),
        textposition:'outside',
        textfont:{color:'#aaa',size:11},
        hovertemplate: ps.map(p=>'<b>Phase '+p.phase+'</b><br>'+p.label+'<br>'+p.count+'건<extra></extra>'),
    }],{...DARK,
        xaxis:{...DARK.xaxis,title:'Phase',tickvals:ps.map(p=>p.phase),ticktext:ps.map(p=>p.phase)},
        yaxis:{...DARK.yaxis,title:'건수'},
        margin:{l:60,r:30,t:20,b:60},
    },{responsive:true});

    // 제외사유 차트
    const er = SEL.exclude_reasons;
    Plotly.newPlot('chartExReasonBar',[{
        y: er.map(r=>r.reason).reverse(),
        x: er.map(r=>r.count).reverse(),
        type:'bar',
        orientation:'h',
        marker:{color:'#60a5fa'},
        text: er.map(r=>r.count+'건').reverse(),
        textposition:'outside',
        textfont:{color:'#aaa',size:11},
        hovertemplate:'%{y}: %{x}건<extra></extra>',
    }],{...DARK,
        xaxis:{...DARK.xaxis,title:'건수'},
        yaxis:{...DARK.yaxis,automargin:true},
        margin:{l:160,r:50,t:10,b:50},
    },{responsive:true});

    // VC 목록 테이블
    renderVCListTable(SEL.vc_list);
    setupVCFilters();

    // 제외 목록 테이블
    renderExListTable(SEL.excluded_list);
    setupExFilters();

    // 미확인 목록
    renderUnkTable(SEL.unknown_list);

    // 카운트 표시
    document.getElementById('vcListCount').textContent = ss.vc_count;
    document.getElementById('exListCount').textContent = ss.excluded_count;
    document.getElementById('unkListCount').textContent = ss.unknown_count;
}

function renderVCListTable(list){
    if(!list.length){document.getElementById('vcListTable').innerHTML='<p style="color:#888">결과 없음</p>';document.getElementById('vcFilterCount').textContent='';return;}
    const phaseColors={'1A':'#3b82f6','1B':'#3b82f6','1C':'#3b82f6','1D':'#3b82f6','1E':'#60a5fa','1F':'#60a5fa','2':'#22c55e','5_auto':'#f59e0b','5':'#a78bfa'};
    let h='<table class="ranking"><thead><tr><th>#</th><th>SPC_NM (주주명)</th><th>유형</th><th>GP명</th><th>Phase</th><th>확인소스</th><th>비고</th></tr></thead><tbody>';
    list.forEach((r,i)=>{
        const pc=phaseColors[r.phase]||'#888';
        h+=`<tr>
            <td>${i+1}</td>
            <td><b>${r.name}</b></td>
            <td>${r.type==='GP(운용사)'?'<span style="color:#f59e0b">GP</span>':'<span style="color:#60a5fa">펀드</span>'}</td>
            <td style="color:#aaa;font-size:12px">${r.gp||'-'}</td>
            <td><span style="display:inline-block;padding:1px 6px;border-radius:3px;font-size:11px;font-weight:600;background:${pc}22;color:${pc}">${r.phase}</span></td>
            <td style="color:#888;font-size:11px;max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap" title="${r.source}">${r.source||'-'}</td>
            <td style="color:#888;font-size:11px;max-width:240px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap" title="${r.note}">${r.note||''}</td>
        </tr>`;
    });
    h+='</tbody></table>';
    document.getElementById('vcListTable').innerHTML=h;
    document.getElementById('vcFilterCount').textContent=list.length+'사 표시';
}

function setupVCFilters(){
    const phases=[...new Set(SEL.vc_list.map(r=>r.phase))].sort();
    const sel=document.getElementById('vcPhaseFilter');
    phases.forEach(p=>{const o=document.createElement('option');o.value=p;o.textContent='Phase '+p;sel.appendChild(o);});

    const doFilter=()=>{
        const q=document.getElementById('vcSearchInput').value.toLowerCase();
        const pf=document.getElementById('vcPhaseFilter').value;
        const tf=document.getElementById('vcTypeFilter').value;
        const filtered=SEL.vc_list.filter(r=>{
            if(pf && r.phase!==pf)return false;
            if(tf && r.type!==tf)return false;
            if(q && !(r.name.toLowerCase().includes(q)||r.gp.toLowerCase().includes(q)||(r.source||'').toLowerCase().includes(q)||r.phase.toLowerCase().includes(q)))return false;
            return true;
        });
        renderVCListTable(filtered);
    };

    document.getElementById('vcSearchInput').addEventListener('input',doFilter);
    document.getElementById('vcPhaseFilter').addEventListener('change',doFilter);
    document.getElementById('vcTypeFilter').addEventListener('change',doFilter);
}

function renderExListTable(list){
    if(!list.length){document.getElementById('exListTable').innerHTML='<p style="color:#888">결과 없음</p>';document.getElementById('exFilterCount').textContent='';return;}
    let h='<table class="ranking"><thead><tr><th>#</th><th>SPC_NM (주주명)</th><th>제외사유</th><th>원래Phase</th><th>비고</th></tr></thead><tbody>';
    list.forEach((r,i)=>{
        h+=`<tr>
            <td>${i+1}</td>
            <td>${r.name}</td>
            <td><span class="tag-exclude">${r.reason}</span></td>
            <td style="color:#888;font-size:12px">${r.orig_phase||'-'}</td>
            <td style="color:#888;font-size:11px;max-width:300px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap" title="${r.note}">${r.note||''}</td>
        </tr>`;
    });
    h+='</tbody></table>';
    document.getElementById('exListTable').innerHTML=h;
    document.getElementById('exFilterCount').textContent=list.length+'사 표시';
}

function setupExFilters(){
    const reasons=[...new Set(SEL.excluded_list.map(r=>r.reason))].sort();
    const sel=document.getElementById('exReasonFilter');
    reasons.forEach(r=>{const o=document.createElement('option');o.value=r;o.textContent=r;sel.appendChild(o);});

    const doFilter=()=>{
        const q=document.getElementById('exSearchInput').value.toLowerCase();
        const rf=document.getElementById('exReasonFilter').value;
        const filtered=SEL.excluded_list.filter(r=>{
            if(rf && r.reason!==rf)return false;
            if(q && !(r.name.toLowerCase().includes(q)||(r.reason||'').toLowerCase().includes(q)||(r.note||'').toLowerCase().includes(q)))return false;
            return true;
        });
        renderExListTable(filtered);
    };

    document.getElementById('exSearchInput').addEventListener('input',doFilter);
    document.getElementById('exReasonFilter').addEventListener('change',doFilter);
}

function renderUnkTable(list){
    if(!list.length){document.getElementById('unkListTable').innerHTML='<p style="color:#888">없음</p>';return;}
    let h='<table class="ranking"><thead><tr><th>#</th><th>SPC_NM</th><th>사업자번호</th><th>비고</th></tr></thead><tbody>';
    list.forEach((r,i)=>{
        h+=`<tr><td>${i+1}</td><td>${r.name}</td><td style="color:#888;font-size:12px">${r.bizno}</td><td style="color:#888;font-size:12px">${r.note}</td></tr>`;
    });
    h+='</tbody></table>';
    document.getElementById('unkListTable').innerHTML=h;
}

/* ── 탭: 조기매도 ── */
let earlyRendered = false;
function renderEarlySell(){
    if(earlyRendered) return;
    earlyRendered = true;
    const list = DATA.early_sell_top30;
    if(!list || !list.length){ document.getElementById('tableEarlySell').innerHTML='<p style="color:#888">데이터 없음</p>'; return; }
    const maxAmt = Math.max(...list.map(r=>Math.abs(r.net_amount)));

    let h='<table class="ranking"><thead><tr><th>#</th><th>종목명</th><th>순매매금액</th><th>매도금액</th><th>매수금액</th><th>건수</th><th>비중</th></tr></thead><tbody>';
    list.forEach((r,i)=>{
        const pct = maxAmt>0 ? (Math.abs(r.net_amount)/maxAmt*100) : 0;
        const color = r.net_amount>=0 ? '#ef4444' : '#3b82f6';
        h+=`<tr class="early-row" data-idx="${i}" style="cursor:pointer">
            <td>${i+1}</td>
            <td><b>${r.corp_name}</b></td>
            <td style="color:${color};font-weight:600">${fmtAmt(r.net_amount)}원</td>
            <td style="color:#3b82f6">${fmtAmt(r.sell_amount)}원</td>
            <td style="color:#ef4444">${fmtAmt(r.buy_amount)}원</td>
            <td>${r.tx_count}</td>
            <td style="width:18%"><div class="bar-cell"><div class="bar-fill" style="width:${pct}%;background:${color}"></div></div></td>
        </tr>
        <tr class="early-detail" id="early-detail-${i}" style="display:none">
            <td colspan="7" style="padding:0">
                <div style="background:#14161e;padding:12px 16px;border:1px solid #2a2d3a;border-radius:6px;margin:4px 10px 8px">
                    <div style="font-size:11px;color:#888;margin-bottom:6px">공시내역 (${r.disclosures.length}건) — 클릭하면 DART 공시 페이지로 이동</div>
                    <table class="ranking" style="font-size:12px">
                        <thead><tr><th>일자</th><th>경과일</th><th>VC(주주)</th><th>유형</th><th>금액</th><th>수량</th><th>DART 공시</th></tr></thead>
                        <tbody>${r.disclosures.map(d=>{
                            const dartUrl = d.rcept_no ? 'https://dart.fss.or.kr/dsaf001/main.do?rcpNo='+d.rcept_no : '';
                            const dartLink = dartUrl ? '<a href="'+dartUrl+'" target="_blank" rel="noopener" style="color:#60a5fa;text-decoration:none">'+d.rcept_no+'</a>' : '-';
                            const dcolor = d.amount>=0 ? '#ef4444' : '#3b82f6';
                            return `<tr>
                                <td>${d.date}</td>
                                <td>+${d.days}일</td>
                                <td>${d.vc}</td>
                                <td>${d.type}</td>
                                <td style="color:${dcolor}">${fmtAmt(d.amount)}원</td>
                                <td style="color:${dcolor}">${d.shares.toLocaleString()}주</td>
                                <td>${dartLink}</td>
                            </tr>`;
                        }).join('')}</tbody>
                    </table>
                </div>
            </td>
        </tr>`;
    });
    h+='</tbody></table>';
    document.getElementById('tableEarlySell').innerHTML=h;

    // 클릭으로 공시내역 토글
    document.querySelectorAll('.early-row').forEach(row=>{
        row.addEventListener('click',()=>{
            const idx=row.dataset.idx;
            const detail=document.getElementById('early-detail-'+idx);
            detail.style.display=detail.style.display==='none'?'table-row':'none';
        });
    });
}

/* ── Tabs ── */
function initTabs(){
    document.querySelectorAll('.tab').forEach(el=>{
        el.addEventListener('click',()=>{
            const tab=el.dataset.tab;
            document.querySelectorAll('.tab').forEach(t=>t.classList.toggle('active',t.dataset.tab===tab));
            ['net','type','corp','vc','early','criteria'].forEach(t=>{
                const p=document.getElementById('tab-'+t);
                if(p) p.style.display=t===tab?'block':'none';
            });
            if(tab==='type') setTimeout(()=>{renderTypeBar();renderTypeTime();},80);
            if(tab==='corp') setTimeout(renderCorpRanking,80);
            if(tab==='vc') setTimeout(renderVCRanking,80);
            if(tab==='early') setTimeout(renderEarlySell,80);
            if(tab==='criteria') setTimeout(renderCriteria,80);
        });
    });
}
</script>
</body>
</html>
