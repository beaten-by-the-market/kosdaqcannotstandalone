<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>코스닥 신규상장 - VC 매매 분석</title>
    <!--
        데이터 출처: KRX 전자공시 (fair.krx.co.kr) 임원/주요주주 소유보고
        VC 식별: VC_판별_프로세스.md 참조
          - 키워드 매칭 (투자, 벤처, 캐피탈 등 13개 키워드)
          - 벤처투자종합포털(vcs.go.kr) 등록 726개사 대조 (정확+부분 매칭)
          - 수동 검증으로 노이즈 8건 제외
        분석 대상 매매: 장내매매, 장외매매, 시간외매매만 포함
          - 매도: 장내매도(-), 장외매도(-), 시간외매매(-)
          - 매수: 장내매수(+), 장외매수(+)
          - 신규상장/등록, CB/BW, 기타 등은 제외
    -->
    <script src="https://cdn.plot.ly/plotly-2.35.0.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', -apple-system, sans-serif; background: #0f1117; color: #e0e0e0; }
        .header { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); padding: 28px 40px; border-bottom: 1px solid #2a2a4a; }
        .header h1 { font-size: 24px; font-weight: 600; color: #fff; }
        .header p { font-size: 14px; color: #888; margin-top: 5px; }
        .header .note { font-size: 11px; color: #666; margin-top: 10px; line-height: 1.6; border-top: 1px solid #2a2a4a; padding-top: 10px; }
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(155px, 1fr)); gap: 12px; padding: 18px 40px; }
        .summary-card { background: #1a1d29; border: 1px solid #2a2d3a; border-radius: 10px; padding: 14px 16px; }
        .summary-card .label { font-size: 10px; color: #888; text-transform: uppercase; letter-spacing: .5px; }
        .summary-card .value { font-size: 20px; font-weight: 700; margin-top: 3px; }
        .summary-card .sub { font-size: 11px; color: #666; margin-top: 2px; }
        .positive { color: #ef4444; } .negative { color: #3b82f6; } .neutral { color: #fff; }
        .chart-container { padding: 10px 40px; }
        .chart-box { background: #1a1d29; border: 1px solid #2a2d3a; border-radius: 10px; padding: 20px; margin-bottom: 14px; }
        .chart-title { font-size: 16px; font-weight: 600; margin-bottom: 3px; color: #fff; }
        .chart-subtitle { font-size: 12px; color: #888; margin-bottom: 10px; }
        .tab-bar { display: flex; gap: 4px; padding: 10px 40px 0; }
        .tab { padding: 10px 20px; background: #1a1d29; border: 1px solid #2a2d3a; border-bottom: none; border-radius: 8px 8px 0 0; cursor: pointer; font-size: 13px; color: #888; transition: all .15s; }
        .tab:hover { color: #ccc; } .tab.active { color: #fff; border-color: #3b82f6; }
        table.ranking { width: 100%; border-collapse: collapse; font-size: 13px; }
        table.ranking th { text-align: left; padding: 8px 10px; color: #888; border-bottom: 1px solid #2a2d3a; font-weight: 500; font-size: 11px; }
        table.ranking td { padding: 6px 10px; border-bottom: 1px solid #1f2230; }
        table.ranking tr:hover { background: #1f2233; }
        .bar-cell { display: flex; align-items: center; gap: 6px; }
        .bar-fill { height: 6px; border-radius: 3px; min-width: 2px; }
        /* ── VC 확인기준 탭 ── */
        .doc { padding: 24px 32px; line-height: 1.8; font-size: 14px; color: #d0d0d0; }
        .doc h2 { font-size: 18px; font-weight: 700; color: #fff; margin: 28px 0 12px; padding-bottom: 6px; border-bottom: 1px solid #2a2d3a; }
        .doc h2:first-child { margin-top: 0; }
        .doc h3 { font-size: 15px; font-weight: 600; color: #e0e0e0; margin: 20px 0 8px; }
        .doc p { margin: 6px 0; }
        .doc blockquote { border-left: 3px solid #3b82f6; padding: 8px 16px; margin: 10px 0; background: rgba(59,130,246,0.08); border-radius: 0 6px 6px 0; color: #93c5fd; font-weight: 500; }
        .doc ul, .doc ol { margin: 6px 0 6px 20px; }
        .doc li { margin: 3px 0; }
        .doc table { width: 100%; border-collapse: collapse; margin: 10px 0; font-size: 13px; }
        .doc th { text-align: left; padding: 8px 12px; background: #1f2233; color: #93c5fd; border-bottom: 2px solid #2a2d3a; font-weight: 600; font-size: 12px; white-space: nowrap; }
        .doc td { padding: 6px 12px; border-bottom: 1px solid #1f2230; vertical-align: top; }
        .doc tr:hover { background: #1a1d2a; }
        .doc .tag-include { display: inline-block; padding: 1px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; background: rgba(239,68,68,0.15); color: #ef4444; }
        .doc .tag-exclude { display: inline-block; padding: 1px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; background: rgba(59,130,246,0.15); color: #60a5fa; }
        .doc .tag-keyword { display: inline-block; padding: 2px 8px; margin: 2px; border-radius: 4px; font-size: 12px; background: #1f2233; color: #a78bfa; border: 1px solid #3a3d4a; font-family: monospace; }
        .doc .stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 10px; margin: 12px 0; }
        .doc .stat-item { background: #1a1d29; border: 1px solid #2a2d3a; border-radius: 8px; padding: 12px 16px; text-align: center; }
        .doc .stat-item .num { font-size: 22px; font-weight: 700; color: #fff; }
        .doc .stat-item .desc { font-size: 11px; color: #888; margin-top: 2px; }
        .doc .case-box { background: #14161e; border: 1px solid #2a2d3a; border-radius: 8px; padding: 14px 18px; margin: 10px 0; }
        .doc .case-box .case-title { font-size: 13px; font-weight: 600; color: #f59e0b; margin-bottom: 6px; }
        .doc .case-box ul { margin: 4px 0 4px 16px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>코스닥 신규상장 종목 - VC 매매 분석</h1>
        <p>상장일 이후 경과일별 VC(벤처캐피탈)의 순매수/매도 규모 분석</p>
        <div class="note">
            데이터: KRX 전자공시(fair.krx.co.kr) 임원/주요주주 소유보고 &nbsp;|&nbsp;
            VC 식별: 키워드 매칭 + 벤처투자종합포털(vcs.go.kr) 등록 VC 대조 (상세: VC_판별_프로세스.md) &nbsp;|&nbsp;
            분석 대상: <b>장내매매, 장외매매, 시간외매매</b>만 포함 (신규상장/등록, CB/BW, 기타 등 제외)
        </div>
    </div>

    <div class="summary-grid" id="summaryGrid"></div>

    <div class="tab-bar" id="tabBar">
        <div class="tab active" data-tab="net">순매수/매도</div>
        <div class="tab" data-tab="type">매매유형별</div>
        <div class="tab" data-tab="corp">종목 랭킹</div>
        <div class="tab" data-tab="vc">VC 랭킹</div>
        <div class="tab" data-tab="criteria">VC 확인기준</div>
    </div>

    <!-- 탭1: 순매수/매도 -->
    <div id="tab-net" class="chart-container">
        <div class="chart-box">
            <div class="chart-title">경과일별 VC 순매수 (30일 단위)</div>
            <div class="chart-subtitle">상장일 기준 경과일 구간별 순매수 주식수 합계 (전 종목 합산). 점선 = 보호예수 해제 기준일</div>
            <div id="chartNetBar" style="height:420px;"></div>
        </div>
        <div class="chart-box">
            <div class="chart-title">누적 순매수 추이</div>
            <div class="chart-subtitle">경과일에 따른 VC의 누적 순매수 변화</div>
            <div id="chartCumulative" style="height:360px;"></div>
        </div>
        <div class="chart-box">
            <div class="chart-title">매수 vs 매도 (30일 단위)</div>
            <div class="chart-subtitle">매수(빨강)와 매도(파랑)를 분리하여 표시</div>
            <div id="chartBuySell" style="height:380px;"></div>
        </div>
    </div>

    <!-- 탭2: 매매유형별 -->
    <div id="tab-type" class="chart-container" style="display:none;">
        <div class="chart-box">
            <div class="chart-title">매매유형별 총 거래량</div>
            <div id="chartTypeBar" style="height:340px;"></div>
        </div>
        <div class="chart-box">
            <div class="chart-title">매매유형별 경과일 추이</div>
            <div class="chart-subtitle">범례 클릭으로 개별 유형 토글</div>
            <div id="chartTypeTime" style="height:400px;"></div>
        </div>
    </div>

    <!-- 탭3: 종목 랭킹 -->
    <div id="tab-corp" class="chart-container" style="display:none;">
        <div class="chart-box">
            <div class="chart-title">순매도 상위 종목 TOP 30 (VC 엑시트 규모)</div>
            <div id="tableSell"></div>
        </div>
        <div class="chart-box">
            <div class="chart-title">순매수 상위 종목 TOP 30</div>
            <div id="tableBuy"></div>
        </div>
    </div>

    <!-- 탭4: VC 랭킹 -->
    <div id="tab-vc" class="chart-container" style="display:none;">
        <div class="chart-box">
            <div class="chart-title">순매도 상위 VC TOP 30</div>
            <div class="chart-subtitle">가장 많이 매도한 VC(주주)</div>
            <div id="tableVCSell"></div>
        </div>
        <div class="chart-box">
            <div class="chart-title">순매수 상위 VC TOP 30</div>
            <div class="chart-subtitle">가장 많이 매수한 VC(주주)</div>
            <div id="tableVCBuy"></div>
        </div>
    </div>

    <!-- 탭5: VC 확인기준 -->
    <div id="tab-criteria" class="chart-container" style="display:none;">

        <!-- 개요 -->
        <div class="chart-box">
            <div class="doc">
                <h2>개요</h2>
                <p>코스닥 신규상장 종목의 임원/주요주주 소유보고 데이터에서 <b>VC(벤처캐피탈)에 해당하는 주주</b>를 판별한 기준과 프로세스.</p>
                <div class="stat-grid">
                    <div class="stat-item"><div class="num">671</div><div class="desc">분석 대상 종목 (2017~2024)</div></div>
                    <div class="stat-item"><div class="num">40,423</div><div class="desc">원본 소유보고 레코드</div></div>
                    <div class="stat-item"><div class="num">5,602</div><div class="desc">원본 unique 주주</div></div>
                    <div class="stat-item"><div class="num">960</div><div class="desc">최종 VC 주주</div></div>
                    <div class="stat-item"><div class="num">7,452</div><div class="desc">최종 VC 레코드</div></div>
                </div>
                <p style="font-size:12px;color:#888;">데이터 출처: KRX 전자공시 (<code style="color:#a78bfa">fair.krx.co.kr</code>) | 수집 기간: 각 종목 상장일 ~ +2년</p>
            </div>
        </div>

        <!-- 핵심 원칙 -->
        <div class="chart-box">
            <div class="doc">
                <h2>핵심 원칙</h2>
                <blockquote>본업이 벤처/스타트업 투자인지가 유일한 핵심 기준이다.</blockquote>
                <ol>
                    <li>VCS(벤처투자종합포털) 등록 여부를 우선 참조하되, <b>등록만으로 자동 포함하지 않음</b></li>
                    <li>키워드 매칭은 <b>후보 추출용</b>이며, 최종 판단은 실체 확인 후 결정</li>
                    <li>법적 라이선스(신기술사 등)가 있더라도 <b>부수적 업무이면 제외</b></li>
                </ol>
            </div>
        </div>

        <!-- 포함/제외 대상 -->
        <div class="chart-box">
            <div class="doc">
                <h2>포함 대상 <span class="tag-include">INCLUDE</span></h2>
                <table>
                    <thead><tr><th>유형</th><th>설명</th><th>예시</th></tr></thead>
                    <tbody>
                        <tr><td>벤처투자회사(창투사)</td><td>벤처투자 촉진에 관한 법률 등록</td><td>한국투자파트너스, 스톤브릿지벤처스</td></tr>
                        <tr><td>신기술사업금융업자(신기사)</td><td>벤처투자가 <b>본업</b>인 신기술금융사</td><td>에스티캐피탈, 무림캐피탈</td></tr>
                        <tr><td>투자조합/벤처펀드</td><td>VC가 GP로 운용하는 투자조합/펀드</td><td>스톤브릿지2020벤처투자조합</td></tr>
                        <tr><td>CVC(기업형 VC)</td><td>대기업 전담 벤처투자 자회사</td><td>펄어비스캐피탈, 롯데벤처스</td></tr>
                        <tr><td>액셀러레이터</td><td>초기 스타트업 투자/보육</td><td>빅뱅벤처스, 제로원액셀러레이터</td></tr>
                        <tr><td>글로벌 VC</td><td>해외 벤처캐피탈</td><td>Insight Partners, IDG Accel</td></tr>
                        <tr><td>창업벤처전문 PEF</td><td>"창업벤처전문" 등록 사모투자합자회사</td><td>유암코헬리오스중소기업성장창업벤처전문사모투자합자회사</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="chart-box">
            <div class="doc">
                <h2>제외 대상 <span class="tag-exclude">EXCLUDE</span></h2>
                <table>
                    <thead><tr><th>유형</th><th>판단 근거</th><th style="text-align:right">주주 수</th><th style="text-align:right">레코드 수</th></tr></thead>
                    <tbody>
                        <tr><td><b>증권사</b></td><td>IPO 주관/인수/중개가 본업. 신기술사 등록도 부수적</td><td style="text-align:right">28</td><td style="text-align:right">5,101</td></tr>
                        <tr><td><b>자산운용사</b></td><td>공모펀드/ETF/헤지펀드 운용이 본업</td><td style="text-align:right">32</td><td style="text-align:right">1,010</td></tr>
                        <tr><td><b>캐피탈사(여신전문금융)</b></td><td>리스/대출/할부금융이 본업</td><td style="text-align:right">11</td><td style="text-align:right">131</td></tr>
                        <tr><td><b>투자자문/투자일임</b></td><td>공모주/메자닌/상장주식 자문이 본업</td><td style="text-align:right">7</td><td style="text-align:right">16</td></tr>
                        <tr><td><b>구조조정 펀드</b></td><td>"기업재무안정"/"턴어라운드" 목적 PEF</td><td style="text-align:right">7</td><td style="text-align:right">67</td></tr>
                        <tr><td><b>정부기관/비영리</b></td><td>정책자금 집행 기관, 비영리 재단</td><td style="text-align:right">2</td><td style="text-align:right">28</td></tr>
                        <tr><td><b>기타</b></td><td>패밀리오피스, 투자지주, PE SPV 등</td><td style="text-align:right">5</td><td style="text-align:right">138</td></tr>
                        <tr style="font-weight:700;border-top:2px solid #3a3d4a"><td>합계</td><td></td><td style="text-align:right">92</td><td style="text-align:right">6,491</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 주요 판단 사례 -->
        <div class="chart-box">
            <div class="doc">
                <h2>주요 판단 사례</h2>

                <div class="case-box">
                    <div class="case-title">"캐피탈"이 이름에 포함된 경우 &mdash; 개별 확인 필수</div>
                    <ul>
                        <li><span class="tag-exclude">제외</span> 여신전문금융(리스/대출 본업): 신한캐피탈, 하나캐피탈, 메리츠캐피탈, 아이비케이캐피탈, 키움캐피탈 등 11개</li>
                        <li><span class="tag-include">포함</span> 신기사(벤처투자 본업): 타임폴리오캐피탈, 펄어비스캐피탈, 뉴메인캐피탈, 무림캐피탈, 에스티캐피탈</li>
                    </ul>
                </div>

                <div class="case-box">
                    <div class="case-title">증권사의 신기술사 등록 &mdash; 모두 제외</div>
                    <ul>
                        <li><span class="tag-exclude">제외</span> 하나증권, 한화투자증권, 신영증권, 코리아에셋투자증권, 에스케이증권, 유진투자증권, 비엔케이투자증권</li>
                        <li>본업은 증권 중개/IB이며, 신기술사업금융은 부수적 라이선스에 불과</li>
                    </ul>
                </div>

                <div class="case-box">
                    <div class="case-title">유암코(연합자산관리) 펀드 &mdash; 펀드명으로 구분</div>
                    <ul>
                        <li><span class="tag-exclude">제외</span> "기업재무안정"/"크레딧"/"젤코바" &rarr; 구조조정/NPL</li>
                        <li><span class="tag-include">포함</span> "창업벤처전문"/"중소기업성장" + VC GP &rarr; 벤처투자</li>
                    </ul>
                </div>

                <div class="case-box">
                    <div class="case-title">사모투자합자회사(PEF) &mdash; 펀드명/GP로 구분</div>
                    <ul>
                        <li><span class="tag-exclude">제외</span> "기업재무안정"/"턴어라운드"/"스페셜시츄에이션"</li>
                        <li><span class="tag-include">포함</span> "창업벤처전문" 등록, 또는 VC가 GP인 성장 펀드</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- 판별 프로세스 -->
        <div class="chart-box">
            <div class="doc">
                <h2>판별 프로세스</h2>

                <h3>Step 1: 후보 추출</h3>
                <p>3가지 방법을 OR 조건으로 병합하여 VC 후보를 추출.</p>
                <table>
                    <thead><tr><th>방법</th><th>내용</th><th style="text-align:right">매칭 수</th></tr></thead>
                    <tbody>
                        <tr><td>키워드 매칭</td><td>주주명에 13개 키워드 포함 여부</td><td style="text-align:right">1,049명</td></tr>
                        <tr><td>VCS 정확 매칭</td><td>VCS 등록 기관명과 주주명 완전 일치</td><td style="text-align:right">82명</td></tr>
                        <tr><td>VCS 부분 매칭</td><td>VCS 기관명 &harr; 주주명 상호 포함 (3글자 이상) &rarr; 수동 검증</td><td style="text-align:right">41명</td></tr>
                    </tbody>
                </table>

                <p style="margin-top:12px"><b>사용 키워드</b> (13개):</p>
                <div style="margin:6px 0">
                    <span class="tag-keyword">투자</span><span class="tag-keyword">벤처</span><span class="tag-keyword">캐피탈</span><span class="tag-keyword">파트너스</span><span class="tag-keyword">인베스트</span><span class="tag-keyword">에셋</span><span class="tag-keyword">창투</span><span class="tag-keyword">펀드</span><span class="tag-keyword">fund</span><span class="tag-keyword">capital</span><span class="tag-keyword">venture</span><span class="tag-keyword">invest</span><span class="tag-keyword">partner</span>
                </div>

                <p><b>VCS 등록 VC</b>: 726개사 (벤처투자회사 250, 기타운용사 374, LLC 60, 신기술사 42)</p>
                <p><b>1차 통합 결과</b>: 14,028건 / 1,061명 (부분 매칭 노이즈 8건 제외 후)</p>

                <h3 style="margin-top:20px">Step 2: 비VC 제거</h3>
                <p>후보에서 7개 카테고리의 비VC를 식별/제거 &rarr; <b>92개 주주 / 6,491건 제거</b></p>

                <h3 style="margin-top:20px">Step 3: 전수점검</h3>
                <p>KVCA 조합현황, VCS 등록 목록, KVCA 회원사 목록과 대조하여 전수 재확인.</p>
                <ul>
                    <li>원본 데이터 미존재 2건 제거 (phantom entries)</li>
                    <li>비VC 5건 제거 (포항공과대학교 산학협력단, 제이비우리페트리코 등)</li>
                    <li>메자닌/PE 2건 추가 제거 (엔브이메자닌플러스사모투자합자회사, 디비투자조합)</li>
                </ul>

                <h3 style="margin-top:20px">최종 결과</h3>
                <table>
                    <thead><tr><th>구분</th><th style="text-align:right">레코드 수</th><th style="text-align:right">unique 주주 수</th></tr></thead>
                    <tbody>
                        <tr><td>후보 추출 (키워드+VCS OR)</td><td style="text-align:right">14,028</td><td style="text-align:right">1,061</td></tr>
                        <tr><td>비VC 제거</td><td style="text-align:right;color:#3b82f6">-6,491</td><td style="text-align:right;color:#3b82f6">-92</td></tr>
                        <tr><td>전수점검 정정</td><td style="text-align:right;color:#3b82f6">-85</td><td style="text-align:right;color:#3b82f6">-9</td></tr>
                        <tr style="font-weight:700"><td>최종 VC</td><td style="text-align:right">7,452</td><td style="text-align:right">960</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 제외 상세 목록 -->
        <div class="chart-box">
            <div class="doc">
                <h2>제외 상세 목록</h2>

                <h3>증권사 (28개)</h3>
                <p style="font-size:12px;color:#888;">키워드("투자", "에셋" 등) 또는 VCS 신기술사 등록에 의해 매칭. 본업이 증권 중개/IB이므로 전수 제외.</p>
                <table>
                    <thead><tr><th>주주명</th><th>비고</th></tr></thead>
                    <tbody>
                        <tr><td>미래에셋증권, 미래에셋대우</td><td>미래에셋대우는 구명</td></tr>
                        <tr><td>한국투자증권, NH투자증권, 엔에이치투자증권</td><td>엔에이치투자증권 = NH투자증권 한글명</td></tr>
                        <tr><td>신한투자증권, 신한금융투자</td><td>구명. VC는 별도 '신한벤처투자'</td></tr>
                        <tr><td>다올투자증권, 케이티비투자증권, 아이비케이투자증권, IBK투자증권</td><td></td></tr>
                        <tr><td>이베스트투자증권, 하이투자증권, 리딩투자증권, 케이프투자증권</td><td></td></tr>
                        <tr><td>DB금융투자, 디비금융투자</td><td>동일 법인(구 동부증권)</td></tr>
                        <tr><td>하나증권, 하나금융투자, 한화투자증권, 신영증권</td><td>VCS 신기술사 등록</td></tr>
                        <tr><td>코리아에셋투자증권, 에스케이증권, 유진투자증권, 비엔케이투자증권</td><td>VCS 신기술사 등록</td></tr>
                        <tr><td>엔에이치투자증권신탁업자지위로서</td><td>NH투자증권 신탁업자 역할</td></tr>
                        <tr><td>미래에셋드림타겟증권주식, 미래에셋디스커버리증권주식</td><td>공모 주식형 투자신탁(펀드)</td></tr>
                    </tbody>
                </table>

                <h3>자산운용사 (32개)</h3>
                <p style="font-size:12px;color:#888;">공모펀드/ETF/헤지펀드 운용이 본업. 글로벌 19개 + 국내 13개.</p>
                <table>
                    <thead><tr><th>구분</th><th>목록</th></tr></thead>
                    <tbody>
                        <tr><td>글로벌 (19)</td><td style="font-size:12px">Franklin Templeton 계열 10개, Fidelity 2개, JPMorgan 2개, Brookdale 2개, Kayne Anderson, Virtus, Caravan, Miri</td></tr>
                        <tr><td>국내 (13)</td><td style="font-size:12px">미래에셋자산운용, 한국투자밸류자산운용, 한국투자신탁운용, 키움투자자산운용, 에셋플러스자산운용, 제이씨에셋자산운용, 마이퍼스트에셋자산운용, 에셋원자산운용, 지알이파트너스자산운용, 조인에셋글로벌자산운용, 쿼드자산운용, 서울에셋매니지먼트, 느티나무에셋</td></tr>
                    </tbody>
                </table>
                <blockquote>유지: 아이온자산운용, 타이거자산운용투자일임 (VCS 등록, 벤처투자 활동 확인)</blockquote>

                <h3>캐피탈사 &mdash; 여신전문금융 (11개)</h3>
                <p style="font-size:12px;color:#888;">리스/대출/할부금융이 본업인 여신전문금융회사.</p>
                <p style="font-size:13px">산은캐피탈, 신한캐피탈, 하나캐피탈, 메리츠캐피탈, 아이비케이캐피탈, 키움캐피탈, 엠캐피탈, 웰릭스캐피탈, 웰컴캐피탈, 제이비우리캐피탈, 메이슨캐피탈</p>
                <blockquote>유지: 타임폴리오캐피탈, 펄어비스캐피탈(CVC), 뉴메인캐피탈, 무림캐피탈, 에스티캐피탈</blockquote>

                <h3>투자자문/투자일임 (7개)</h3>
                <p style="font-size:13px">마블투자자문, 브라이트투자자문, 스카이투자자문, 시너지투자자문, 유니크투자자문, 코델리아투자자문, 빌앤트리투자일임</p>
                <blockquote>유지: 히스토리투자자문 (VC 자회사 '히스토리벤처투자' 보유)</blockquote>

                <h3>구조조정/재무안정 펀드 (7개)</h3>
                <p style="font-size:12px;color:#888;">"기업재무안정"/"턴어라운드"/"스페셜시츄에이션" 목적의 사모투자합자회사.</p>
                <p style="font-size:12px">유암코아이비케이금융그룹기업재무안정PEF, 유암코젤코바제1호PEF, 유암코케이비크레딧제1호PEF, 유진신영기업구조혁신PEF, 유진에버베스트턴어라운드PEF, 케이비나우스페셜시츄에이션PEF, 나우턴어라운드성장사다리펀드1호PEF</p>
                <blockquote>유지: 유암코삼호그린중소기업성장PEF (VC GP), 유암코헬리오스중소기업성장창업벤처전문PEF ("창업벤처전문" 등록)</blockquote>

                <h3>정부기관/비영리재단 (2개)</h3>
                <p style="font-size:13px">중소벤처기업진흥공단(정부 정책기관), 한국기술벤처재단(비영리재단)</p>

                <h3>기타 (5개)</h3>
                <table>
                    <thead><tr><th>주주명</th><th>실제 정체</th></tr></thead>
                    <tbody>
                        <tr><td>옥타바펀드리미티드</td><td>싱가포르 패밀리오피스</td></tr>
                        <tr><td>에이피아이홍콩인베스트먼트리미티드</td><td>홍콩 투자지주회사</td></tr>
                        <tr><td>프로테라아시아푸드펀드3브이씨씨</td><td>농업 PE 펀드</td></tr>
                        <tr><td>RivendellInvestments20182</td><td>PE SPV</td></tr>
                    </tbody>
                </table>

                <h3>VCS 부분 매칭 노이즈 (8개)</h3>
                <p style="font-size:12px;color:#888;">주주명이 VCS 등록 기관명과 우연히 글자가 겹친 경우.</p>
                <table>
                    <thead><tr><th>주주명</th><th>잘못 매칭된 VC</th><th>실제 정체</th></tr></thead>
                    <tbody>
                        <tr><td>스노우</td><td>스노우볼벤처스</td><td>네이버 자회사</td></tr>
                        <tr><td>에코프로</td><td>에코프로파트너스</td><td>2차전지 제조사</td></tr>
                        <tr><td>인탑스</td><td>인탑스인베스트먼트</td><td>코스닥 제조업체</td></tr>
                        <tr><td>카카오</td><td>카카오벤처스</td><td>IT 플랫폼 기업</td></tr>
                        <tr><td>케이티</td><td>케이티인베스트먼트</td><td>통신사</td></tr>
                        <tr><td>이지원</td><td>세이지원파트너스</td><td>개인명</td></tr>
                        <tr><td>에스와이</td><td>에스와이피</td><td>글자 겹침</td></tr>
                        <tr><td>이엠비</td><td>제이엠비즈솔루션</td><td>글자 겹침</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 데이터 출처 -->
        <div class="chart-box">
            <div class="doc">
                <h2>데이터 출처</h2>
                <table>
                    <thead><tr><th>파일</th><th>출처</th><th>설명</th></tr></thead>
                    <tbody>
                        <tr><td><code style="color:#a78bfa">kosdaq신규상장.xlsx</code></td><td>KRX 정보데이터시스템 (data.krx.co.kr)</td><td>코스닥 신규상장 종목 671개</td></tr>
                        <tr><td><code style="color:#a78bfa">임원주요주주_보고.xlsx</code></td><td>KRX 전자공시 (fair.krx.co.kr) API</td><td>임원/주요주주 소유보고 40,513건</td></tr>
                        <tr><td><code style="color:#a78bfa">등록_벤처투자회사_목록.csv</code></td><td>VCS 벤처투자종합포털 (vcs.go.kr) API</td><td>등록 벤처투자회사 726개사</td></tr>
                        <tr><td><code style="color:#a78bfa">kvca_회원사_목록.csv</code></td><td>KVCA 한국벤처캐피탈협회 (kvca.or.kr)</td><td>협회 회원사 213개사 (교차검증용)</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

    </div>

<script>
let DATA = null;
fetch('vc_analysis_data.json?t='+Date.now()).then(r=>{if(!r.ok)throw new Error(r.status);return r.json();}).then(d=>{DATA=d;init();}).catch(e=>document.body.innerHTML='<h2 style="color:red;padding:40px">JSON 로드 실패: '+e.message+'</h2>');

function init(){
    renderSummary();
    renderNetBar();
    renderCumulative();
    renderBuySell();
    initTabs();
}

/* ── Util ── */
function fmt(n){
    const a=Math.abs(n),s=n<0?'-':'';
    if(a>=1e8)return s+(a/1e8).toFixed(1)+'억';
    if(a>=1e4)return s+Math.round(a/1e4)+'만';
    return n.toLocaleString();
}

const TYPE_COLORS={'장내매도':'#3b82f6','장내매수':'#ef4444','장외매도':'#60a5fa','장외매수':'#f87171','시간외매매':'#a78bfa'};

const DARK={
    paper_bgcolor:'rgba(0,0,0,0)',plot_bgcolor:'rgba(0,0,0,0)',
    font:{color:'#ccc',size:12},
    xaxis:{gridcolor:'#2a2d3a',zerolinecolor:'#3a3d4a'},
    yaxis:{gridcolor:'#2a2d3a',zerolinecolor:'#3a3d4a'},
    margin:{l:70,r:30,t:20,b:50},
    hoverlabel:{bgcolor:'#1a1d29',font:{color:'#fff'}},
};

/* 보호예수 해제 기준선 */
const VLINES = [
    {day:180, label:'6개월', color:'#f59e0b'},
    {day:365, label:'1년', color:'#22c55e'},
    {day:540, label:'18개월', color:'#ec4899'},
    {day:730, label:'2년', color:'#8b5cf6'},
];

function addVLines(layout) {
    layout.shapes = VLINES.map(v => ({
        type:'line', x0:v.day, x1:v.day, y0:0, y1:1, yref:'paper',
        line:{color:v.color, width:1.5, dash:'dot'},
    }));
    layout.annotations = VLINES.map(v => ({
        x:v.day, y:1.02, yref:'paper', text:v.label,
        showarrow:false, font:{size:10,color:v.color}, xanchor:'center',
    }));
    return layout;
}

/* ── Summary ── */
function renderSummary(){
    const s=DATA.summary;
    const cards=[
        {l:'분석 종목',v:s.total_stocks+'개',c:'neutral'},
        {l:'VC 주주',v:s.total_vcs+'사',c:'neutral'},
        {l:'매수',v:s.buy_count.toLocaleString()+'건',c:'neutral',sub:'+'+fmt(s.buy)+'주'},
        {l:'매도',v:s.sell_count.toLocaleString()+'건',c:'neutral',sub:fmt(s.sell)+'주'},
        {l:'순매수',v:(s.total_net>0?'+':'')+fmt(s.total_net)+'주',c:s.total_net>=0?'positive':'negative'},
    ];
    document.getElementById('summaryGrid').innerHTML=cards.map(c=>
        `<div class="summary-card"><div class="label">${c.l}</div><div class="value ${c.c}">${c.v}</div>${c.sub?'<div class="sub">'+c.sub+'</div>':''}</div>`
    ).join('');
}

/* ── 탭1 ── */
function renderNetBar(){
    const d=DATA.total_bin;
    const layout=addVLines({...DARK, xaxis:{...DARK.xaxis,title:'상장 후 경과일',dtick:60}, yaxis:{...DARK.yaxis,title:'순매수(주)'}});
    Plotly.newPlot('chartNetBar',[{
        x:d.map(r=>r.days),y:d.map(r=>r.net),type:'bar',
        marker:{color:d.map(r=>r.net>=0?'#ef4444':'#3b82f6')},
        hovertemplate:'경과일 %{x}~%{x}+30일<br>순매수: %{y:,.0f}주<extra></extra>'
    }],layout,{responsive:true});
}

function renderCumulative(){
    const d=DATA.total_bin;
    const layout=addVLines({...DARK, xaxis:{...DARK.xaxis,title:'상장 후 경과일',dtick:60}, yaxis:{...DARK.yaxis,title:'누적 순매수(주)'}});
    Plotly.newPlot('chartCumulative',[{
        x:d.map(r=>r.days),y:d.map(r=>r.cum),type:'scatter',mode:'lines',
        fill:'tozeroy',line:{color:'#8b5cf6',width:2},fillcolor:'rgba(139,92,246,0.12)',
        hovertemplate:'경과일 %{x}일<br>누적: %{y:,.0f}주<extra></extra>'
    }],layout,{responsive:true});
}

function renderBuySell(){
    const d=DATA.type_pivot, days=d.map(r=>r.days);
    const buySum=d.map(r=>(['장내매수','장외매수'].reduce((s,k)=>s+(r[k]||0),0)));
    const sellSum=d.map(r=>(['장내매도','장외매도','시간외매매'].reduce((s,k)=>s+(r[k]||0),0)));
    const layout=addVLines({...DARK, barmode:'relative', xaxis:{...DARK.xaxis,title:'상장 후 경과일',dtick:60}, yaxis:{...DARK.yaxis,title:'주식수'},
        legend:{x:0.01,y:0.99,bgcolor:'rgba(0,0,0,0)'}});
    Plotly.newPlot('chartBuySell',[
        {x:days,y:buySum,name:'매수',type:'bar',marker:{color:'#ef4444'},hovertemplate:'경과일 %{x}일<br>매수: +%{y:,.0f}주<extra></extra>'},
        {x:days,y:sellSum,name:'매도',type:'bar',marker:{color:'#3b82f6'},hovertemplate:'경과일 %{x}일<br>매도: %{y:,.0f}주<extra></extra>'}
    ],layout,{responsive:true});
}

/* ── 탭2 ── */
function renderTypeBar(){
    const d=DATA.type_total;
    Plotly.newPlot('chartTypeBar',[{
        x:d.map(r=>r.type),y:d.map(r=>r.total),type:'bar',
        marker:{color:d.map(r=>TYPE_COLORS[r.type]||'#888')},
        text:d.map(r=>fmt(r.total)+' ('+r.count+'건)'),textposition:'outside',textfont:{color:'#aaa',size:11},
        hovertemplate:'%{x}<br>%{y:,.0f}주<extra></extra>'
    }],{...DARK,xaxis:{...DARK.xaxis},yaxis:{...DARK.yaxis,title:'총 증감(주)'},margin:{...DARK.margin,b:70}},{responsive:true});
}

function renderTypeTime(){
    const traces=DATA.types.map(t=>{
        const pts=DATA.type_pivot.map(r=>({d:r.days,v:r[t]||0}));
        return{x:pts.map(p=>p.d),y:pts.map(p=>p.v),name:t,type:'scatter',mode:'lines',
            line:{color:TYPE_COLORS[t]||'#888',width:2},hovertemplate:t+'<br>경과일 %{x}일: %{y:,.0f}주<extra></extra>'};
    });
    const layout=addVLines({...DARK,xaxis:{...DARK.xaxis,title:'상장 후 경과일',dtick:60},yaxis:{...DARK.yaxis,title:'주식수'},
        legend:{orientation:'h',y:-0.18,font:{size:11}},margin:{...DARK.margin,b:90}});
    Plotly.newPlot('chartTypeTime',traces,layout,{responsive:true});
}

/* ── 탭3: 종목 랭킹 ── */
function renderCorpRanking(){
    renderCorpTable('tableSell',DATA.corp_top_sell);
    renderCorpTable('tableBuy',DATA.corp_top_buy);
}

function fmtVCs(vcs){
    if(!vcs||!vcs.length)return'-';
    const s=vcs.slice(0,3).join(', ');
    return vcs.length>3?s+' 외 '+(vcs.length-3)+'사':s;
}

function renderCorpTable(id,list){
    const maxAbs=Math.max(...list.map(r=>Math.abs(r.net_shares)));
    let h='<table class="ranking"><thead><tr><th>#</th><th>종목명</th><th>순매수(주)</th><th>매도</th><th>매수</th><th>건수</th><th>매도 VC</th><th>매수 VC</th><th></th></tr></thead><tbody>';
    list.forEach((r,i)=>{
        const pct=Math.abs(r.net_shares)/maxAbs*100;
        const color=r.net_shares>=0?'#ef4444':'#3b82f6';
        h+=`<tr><td>${i+1}</td><td><b>${r.CORP_NM}</b></td>
            <td class="${r.net_shares>=0?'positive':'negative'}">${fmt(r.net_shares)}</td>
            <td style="color:#3b82f6">${fmt(r.sell_shares)}</td>
            <td style="color:#ef4444">${r.buy_shares?'+'+fmt(r.buy_shares):'0'}</td>
            <td>${r.tx_count}</td>
            <td style="color:#888;font-size:11px;max-width:240px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap" title="${(r.sell_vcs||[]).join(', ')}">${fmtVCs(r.sell_vcs)}</td>
            <td style="color:#888;font-size:11px;max-width:240px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap" title="${(r.buy_vcs||[]).join(', ')}">${fmtVCs(r.buy_vcs)}</td>
            <td style="width:16%"><div class="bar-cell"><div class="bar-fill" style="width:${pct}%;background:${color}"></div></div></td></tr>`;
    });
    h+='</tbody></table>';
    document.getElementById(id).innerHTML=h;
}

/* ── 탭4: VC 랭킹 ── */
function renderVCRanking(){
    renderVCTable('tableVCSell',DATA.vc_top_sell);
    renderVCTable('tableVCBuy',DATA.vc_top_buy);
}

function fmtSource(src){
    if(!src||!src.length)return'';
    return src.map(s=>{
        if(s==='VCS')return'<span style="display:inline-block;padding:0 5px;border-radius:3px;font-size:9px;font-weight:600;background:rgba(139,92,246,0.2);color:#a78bfa;margin-left:4px;vertical-align:middle">VCS</span>';
        if(s==='KVCA')return'<span style="display:inline-block;padding:0 5px;border-radius:3px;font-size:9px;font-weight:600;background:rgba(34,197,94,0.2);color:#4ade80;margin-left:4px;vertical-align:middle">KVCA</span>';
        return'';
    }).join('');
}

function renderVCTable(id,list){
    const maxAbs=Math.max(...list.map(r=>Math.abs(r.net_shares)));
    const isSell=id.includes('Sell');
    let h='<table class="ranking"><thead><tr><th>#</th><th>VC(주주명)</th><th>순매수(주)</th><th>매도</th><th>매수</th><th>건수</th><th>투자종목</th><th></th></tr></thead><tbody>';
    list.forEach((r,i)=>{
        const pct=Math.abs(r.net_shares)/maxAbs*100;
        const color=r.net_shares>=0?'#ef4444':'#3b82f6';
        const corps=r.corps.slice(0,3).join(', ')+(r.corps.length>3?' 외 '+(r.corps.length-3)+'개':'');
        const srcTags=fmtSource(r.source||[]);
        h+=`<tr><td>${i+1}</td><td><b>${r.SHR_HD_NM}</b>${srcTags}</td>
            <td class="${r.net_shares>=0?'positive':'negative'}">${fmt(r.net_shares)}</td>
            <td style="color:#3b82f6">${fmt(r.sell_shares)}</td>
            <td style="color:#ef4444">${r.buy_shares?'+'+fmt(r.buy_shares):'0'}</td>
            <td>${r.tx_count}</td>
            <td style="color:#888;font-size:11px;max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${corps}</td>
            <td style="width:20%"><div class="bar-cell"><div class="bar-fill" style="width:${pct}%;background:${color}"></div></div></td></tr>`;
    });
    h+='</tbody></table>';
    document.getElementById(id).innerHTML=h;
}

/* ── Tabs ── */
function initTabs(){
    document.querySelectorAll('.tab').forEach(el=>{
        el.addEventListener('click',()=>{
            const tab=el.dataset.tab;
            document.querySelectorAll('.tab').forEach(t=>t.classList.toggle('active',t.dataset.tab===tab));
            ['net','type','corp','vc','criteria'].forEach(t=>{
                const p=document.getElementById('tab-'+t);
                if(p) p.style.display=t===tab?'block':'none';
            });
            if(tab==='type') setTimeout(()=>{renderTypeBar();renderTypeTime();},80);
            if(tab==='corp') setTimeout(renderCorpRanking,80);
            if(tab==='vc') setTimeout(renderVCRanking,80);
        });
    });
}
</script>
</body>
</html>
